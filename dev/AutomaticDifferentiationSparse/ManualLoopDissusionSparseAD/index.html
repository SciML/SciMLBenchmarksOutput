<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diffusion operator loop sparse AD benchmarks · The SciML Benchmarks</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://benchmarks.sciml.ai/stable/AutomaticDifferentiationSparse/ManualLoopDissusionSparseAD/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="The SciML Benchmarks logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">The SciML Benchmarks</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLBenchmarks.jl: Benchmarks for Scientific Machine Learning (SciML) and Equation Solvers</a></li><li><span class="tocitem">Multi-Language Wrapper Benchmarks</span><ul><li><a class="tocitem" href="../../MultiLanguage/ode_wrapper_packages/">ODE Solver Multi-Language Wrapper Package Work-Precision Benchmarks (MATLAB, SciPy, Julia, deSolve (R))</a></li><li><a class="tocitem" href="../../MultiLanguage/special_benchmarks/">Special Multi-Language Differential Equation Solver Comparison Benchmarks</a></li></ul></li><li><span class="tocitem">Linear Solvers</span><ul><li><a class="tocitem" href="../../LinearSolve/LUFactorization/">LU Factorization Benchmarks</a></li><li><a class="tocitem" href="../../LinearSolve/MatrixDepot/">Suite Sparse Matrix Jacobian Factorization Benchmarks</a></li><li><a class="tocitem" href="../../LinearSolve/SparsePDE/">Finite Difference Sparse PDE Jacobian Factorization Benchmarks</a></li></ul></li><li><span class="tocitem">Interval Rootfinding</span><ul><li><a class="tocitem" href="../../IntervalNonlinearProblem/simpleintervalrootfind/">Simple Interval Rootfinding (NonlinearSolve.jl vs Roots.jl vs MATLAB)</a></li><li><a class="tocitem" href="../../IntervalNonlinearProblem/suite/">Interval root-finding test suite</a></li></ul></li><li><span class="tocitem">Nonlinear Solvers</span><ul><li><a class="tocitem" href="../../NonlinearProblem/bruss/">Ill-Conditioned Nonlinear System Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonlinearProblem/bruss_krylov/">Ill-Conditioned Nonlinear System Work-Precision Diagrams (Krylov Methods)</a></li><li><a class="tocitem" href="../../NonlinearProblem/nonlinear_battery_problem/">Doyle-Fuller-Newman (DFN) Battery Model Initialization</a></li><li><a class="tocitem" href="../../NonlinearProblem/nonlinear_solver_23_tests/">Nonlinear Solver 23 Test Problems</a></li><li><a class="tocitem" href="../../NonlinearProblem/quadratic_nonlinear/">Quadratic Nonlinear Rootfinding Benchmark</a></li></ul></li><li><span class="tocitem">Automatic Differentiation</span><ul><li><a class="tocitem" href="../../AutomaticDifferentiation/BrussScaling/">Bruss Scaling PDE Differentaition Benchmarks</a></li><li><a class="tocitem" href="../../AutomaticDifferentiation/JuliaAD/">Julia AD Benchmarks</a></li><li><a class="tocitem" href="../../AutomaticDifferentiation/SimpleODEAD/">Differentiation of Simple ODE Benchmarks</a></li></ul></li><li><span class="tocitem">Sparse Automatic Differentiation</span><ul><li><a class="tocitem" href="../BrusselatorSparseAD/">Brusselator sparse AD benchmarks</a></li><li class="is-active"><a class="tocitem" href>Diffusion operator loop sparse AD benchmarks</a><ul class="internal"><li><a class="tocitem" href="#Backends-tested"><span>Backends tested</span></a></li><li><a class="tocitem" href="#Diffusion-operator-simple-loop"><span>Diffusion operator simple loop</span></a></li><li><a class="tocitem" href="#Manual-jacobian"><span>Manual jacobian</span></a></li><li><a class="tocitem" href="#Define-Scenarios"><span>Define Scenarios</span></a></li><li><a class="tocitem" href="#Run-Benchmarks"><span>Run Benchmarks</span></a></li></ul></li></ul></li><li><span class="tocitem">Non-Stiff Ordinary Differential Equations (ODEs)</span><ul><li><a class="tocitem" href="../../NonStiffODE/EnrightPryce_wpd/">Enright-Pryce Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/FitzhughNagumo_wpd/">Fitzhugh-Nagumo Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/LotkaVolterra_wpd/">Lotka-Volterra Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/Pleiades_wpd/">Pleiades Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/RigidBody_wpd/">Rigid Body Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/ThreeBody_wpd/">Three Body Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/linear_wpd/">100 Independent Linear Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Ordinary Differential Equations (ODEs)</span><ul><li><a class="tocitem" href="../../StiffODE/Bruss/">Brusselator Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/E5/">E5 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Hires/">HIRES Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/MKMBatteryChemistry_wpd/">Microkinetic Model (MKM) Battery Chemistry Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Orego/">OREGO Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Pollution/">POLLU Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/ROBER/">ROBER Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/VanDerPol/">VanDerPol Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Biological Differential Equations</span><ul><li><a class="tocitem" href="../../Bio/BCR/">BCR Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/Bidkhori2012/">Bidkhori2012 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/egfr_net/">Egfr_net Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/fceri_gamma2/">Fceri_gamma2 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/multisite2/">Multisite2 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/multistate/">Multistate Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Astrochemistry Differential Equations</span><ul><li><a class="tocitem" href="../../AstroChem/astrochem/">AstroChem Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../AstroChem/nelson/">Nelson Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Differential-Algebraic Equations (DAEs)</span><ul><li><a class="tocitem" href="../../DAE/ChemicalAkzoNobel/">Chemical Akzo Nobel Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/LinearDAE/">Linear Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/NANDGateProblem/">NAND Gate Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/OregoDAE/">OREGO Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/ROBERDAE/">ROBER Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/TransistorAmplifier/">Transistor Amplifier, DAE format</a></li></ul></li><li><span class="tocitem">Non-Stiff Boundary Value Problems (BVPs)</span><ul><li><a class="tocitem" href="../../NonStiffBVP/linear_wpd/">Linear BVP Benchmarks</a></li><li><a class="tocitem" href="../../NonStiffBVP/orbital/">Orbital Dynamics BVP Benchmark</a></li></ul></li><li><span class="tocitem">Stiff Boundary Value Problems (BVPs)</span><ul><li><a class="tocitem" href="../../StiffBVP/ionic_liquid_dehumidifier/">Ionic Liquid Dehumidifier Benchmarks</a></li></ul></li><li><span class="tocitem">ModelingToolkit Acausal Modeling / Symbolic-Numeric Benchmarks</span><ul><li><a class="tocitem" href="../../ModelingToolkit/Multibody_Robot/">Multibody Robot, compilation and simulation performance</a></li><li><a class="tocitem" href="../../ModelingToolkit/RCCircuit/">RC Circuit</a></li><li><a class="tocitem" href="../../ModelingToolkit/ThermalFluid/">Thermal Fluid ODE Compilation and Perf</a></li></ul></li><li><span class="tocitem">Simple Handwritten Partial Differential Equations (PDEs) as ODEs</span><ul><li><a class="tocitem" href="../../SimpleHandwrittenPDE/allen_cahn_fdm_wpd/">Allen-Cahn Finite-Difference Method Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/allen_cahn_spectral_wpd/">Allen-Cahn Pseudospectral Methods Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/burgers_fdm_wpd/">Burgers&#39; Equation Finite-Difference Method Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/burgers_spectral_wpd/">Burgers&#39; Equation Pseudospectral Method Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/kdv_fdm_wpd/">Kortwrieg-de Vries Equation FDM Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/kdv_spectral_wpd/">Korteweg-De Vries Equation Pseudospectral Methods Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/ks_fdm_wpd/">Kuramoto-Sivashinsky Finite-Difference Method Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/ks_spectral_wpd/">Kuramoto-Sivashinsky Pseudospectral Methods Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Complicated Partial Differential Equations (PDEs)</span><ul><li><a class="tocitem" href="../../ComplicatedPDE/Filament/">Filament Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../ComplicatedPDE/SpringBlockNonLinearResistance/">Spring-Block PDE Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Dynamical ODEs (Hamiltonian and Second Order)</span><ul><li><a class="tocitem" href="../../GlobalOptimization/blackbox_global_optimizers/">Black-Box Global Optimizer Benchmarks</a></li></ul></li><li><span class="tocitem">N-Body Problem Benchmarks</span><ul><li><a class="tocitem" href="../../NBodySimulator/acceleration_functions/">Acceleration function benchmarks</a></li><li><a class="tocitem" href="../../NBodySimulator/liquid_argon/">Liquid argon benchmarks</a></li></ul></li><li><span class="tocitem">Non-Stiff Stochastic Differential Equations (SDEs)</span><ul><li><a class="tocitem" href="../../NonStiffSDE/BasicSDEWeakWorkPrecision/">SDE Basic Weak Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffSDE/BasicSDEWorkPrecision/">SDE Basic Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffSDE/LotkaVolterraSDE/">SDE Lokta-Volterra Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Stochastic Differential Equations (SDEs)</span><ul><li><a class="tocitem" href="../../StiffSDE/Oval2LongRun/">Oval2 Long Run</a></li><li><a class="tocitem" href="../../StiffSDE/Oval2LongTimes/">Oval2 Long Times</a></li><li><a class="tocitem" href="../../StiffSDE/Oval2Timings/">Oval2 Timings</a></li><li><a class="tocitem" href="../../StiffSDE/QuadraticStiffness/">Quadratic Stiffness Benchmarks</a></li><li><a class="tocitem" href="../../StiffSDE/StochasticHeat/">Stochastic Heat Equation Benchmarks</a></li></ul></li><li><span class="tocitem">Non-Stiff Delay Differential Equations (DDEs)</span><ul><li><a class="tocitem" href="../../NonStiffDDE/Mackey_Glass_wpd/">Mackey and Glass Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffDDE/Mosquito_wpd/">Mosquito Population State-Dependent DDE Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffDDE/Wheldon_Kirk_Finlay_wpd/">Wheldon, Kirk, and Finlay Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Delay Differential equations (DDEs)</span><ul><li><a class="tocitem" href="../../StiffDDE/QuorumSensing/">Quorum Sensing Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Jump Process Equations (Gillespie Benchmarks)</span><ul><li><a class="tocitem" href="../../Jumps/Diffusion_CTRW/">Diffusion Model</a></li><li><a class="tocitem" href="../../Jumps/EGFR_Benchmark/">EGFR Network Benchmark</a></li><li><a class="tocitem" href="../../Jumps/Mendes_multistate_example/">Mendes Multistate Model</a></li><li><a class="tocitem" href="../../Jumps/MultivariateHawkes/">Multivariate Hawkes Model</a></li><li><a class="tocitem" href="../../Jumps/NegFeedback_GeneExpr/">Negative Feedback Gene Expression Model</a></li><li><a class="tocitem" href="../../Jumps/NegFeedback_GeneExpr_Marchetti/">Negative Feedback Marchetti Model</a></li><li><a class="tocitem" href="../../Jumps/Spatial_Signaling_Sanft/">Spatial Signaling Model from Sanft and Othmer (2015)</a></li></ul></li><li><span class="tocitem">Hybrid (Time-Dependent) Jump Processes</span><ul><li><a class="tocitem" href="../../HybridJumps/MultivariateHawkes/">Multivariate Hawkes Model</a></li><li><a class="tocitem" href="../../HybridJumps/Synapse/">Synapse model</a></li><li><a class="tocitem" href="../../HybridJumps/VR_Aggregator_Benchmark/">Benchmarking Variable Rate Aggregator</a></li></ul></li><li><span class="tocitem">Nonlinear Optimization Solver Benchmarks</span><ul><li><a class="tocitem" href="../../Optimizaton/2drosenbrock/">2-Dimensional Rosenbrock Function Nonlinear Optimization Benchmark</a></li></ul></li><li><span class="tocitem">Global Optimization Benchmarks</span><ul><li><a class="tocitem" href="../../DynamicalODE/Henon-Heiles_energy_conservation_benchmark/">Hénon-Heiles Energy Conservation</a></li><li><a class="tocitem" href="../../DynamicalODE/Quadrupole_boson_Hamiltonian_energy_conservation_benchmark/">Quadruple Boson Energy Conservation</a></li><li><a class="tocitem" href="../../DynamicalODE/single_pendulums/">Single Pedulum Comparison</a></li></ul></li><li><span class="tocitem">Optimization Framework Benchmarks</span><ul><li><a class="tocitem" href="../../OptimizationFrameworks/clnlbeam/">CLNLBEAM Nonlinear Optimization Benchmark</a></li><li><a class="tocitem" href="../../OptimizationFrameworks/optimal_powerflow/">Optimal Powerflow Nonlinear Optimization Benchmark</a></li></ul></li><li><span class="tocitem">Parameter Estimation and Inverse Problem Benchmarks</span><ul><li><a class="tocitem" href="../../ParameterEstimation/FitzHughNagumoParameterEstimation/">FitzHugh-Nagumo Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../ParameterEstimation/LorenzParameterEstimation/">Lorenz Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../ParameterEstimation/LotkaVolterraParameterEstimation/">Lotka-Volterra Parameter Estimation Benchmarks</a></li></ul></li><li><span class="tocitem">Bayesian Inference and Probabilistic Inverse Problem Benchmarks</span><ul><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesFitzHughNagumo/">Fitzhugh-Nagumo Bayesian Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesLorenz/">Lorenz Bayesian Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesLotkaVolterra/">Lotka-Volterra Bayesian Parameter Estimation Benchmarks</a></li></ul></li><li><span class="tocitem">MethodOfLines.jl Partial Differential Equation (PDE) Formulations</span><ul><li><a class="tocitem" href="../../MethodOfLinesPDE/MOL_fdm/">Burgers FDM Work-Precision Diagrams with Various MethodOfLines Methods</a></li></ul></li><li><span class="tocitem">Physics-Informed Neural Network (Neural Network PDE Solver) Cost Function Benchmarks</span><ul><li><a class="tocitem" href="../../PINNErrorsVsTime/allen_cahn_et/">Allen-Cahn PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/diffusion_et/">Diffusion PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/hamilton_jacobi_et/">Hamilton-Jacobi PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/level_set_et/">Level Set PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/nernst_planck_et/">Nernst-Planck PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li></ul></li><li><span class="tocitem">Physics-Informed Neural Network (Neural Network PDE Solver) Optimizer Benchmarks</span><ul><li><a class="tocitem" href="../../PINNOptimizers/1d_diffusion/">Diffusion Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/1d_poisson_nernst_planck/">Nernst-Planck Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/allen_cahn/">Allen-Cahn Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/burgers_equation/">Berger&#39;s Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/hamilton_jacobi/">Hamilton-Jacobi PDE Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/poisson/">Poisson PDE Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li></ul></li><li><span class="tocitem">SDE Adaptivity Benchmarks</span><ul><li><a class="tocitem" href="../../AdaptiveSDE/AdaptiveEfficiencyTests/">Adaptive Efficiency Tests</a></li><li><a class="tocitem" href="../../AdaptiveSDE/qmaxDetermination/">qmax Determination</a></li></ul></li><li><span class="tocitem">Surrogate Benchmarks</span><ul><li><a class="tocitem" href="../../Surrogates/tensor_product/">Tensor Product Function</a></li></ul></li><li><span class="tocitem">Symbolic Manipulation Benchmarks</span><ul><li><a class="tocitem" href="../../Symbolics/BCR/">BCR Symbolic Jacobian</a></li><li><a class="tocitem" href="../../Symbolics/ThermalFluid/">Thermal Fluid Symbolic Jacobian Scaling</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Sparse Automatic Differentiation</a></li><li class="is-active"><a href>Diffusion operator loop sparse AD benchmarks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Diffusion operator loop sparse AD benchmarks</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLBenchmarksOutput/blob/main/docs/src/AutomaticDifferentiationSparse/ManualLoopDissusionSparseAD.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Diffusion-operator-loop-sparse-AD-benchmarks"><a class="docs-heading-anchor" href="#Diffusion-operator-loop-sparse-AD-benchmarks">Diffusion operator loop sparse AD benchmarks</a><a id="Diffusion-operator-loop-sparse-AD-benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-operator-loop-sparse-AD-benchmarks" title="Permalink"></a></h1><pre><code class="language-julia hljs">using DifferentiationInterface
using DifferentiationInterfaceTest
using LinearAlgebra
using SparseConnectivityTracer: TracerSparsityDetector
using SparseMatrixColorings
import Enzyme,ForwardDiff,Mooncake
import Markdown, PrettyTables, Printf</code></pre><h2 id="Backends-tested"><a class="docs-heading-anchor" href="#Backends-tested">Backends tested</a><a id="Backends-tested-1"></a><a class="docs-heading-anchor-permalink" href="#Backends-tested" title="Permalink"></a></h2><pre><code class="language-julia hljs">bcks = [
    AutoEnzyme(mode=Enzyme.Reverse),
    AutoEnzyme(mode=Enzyme.Forward),
    AutoMooncake(config=nothing),
    AutoForwardDiff(),
    AutoSparse(
        AutoForwardDiff();
        sparsity_detector=TracerSparsityDetector(),
        coloring_algorithm=GreedyColoringAlgorithm()
    ),
    AutoSparse(
        AutoEnzyme(mode=Enzyme.Forward);
        sparsity_detector=TracerSparsityDetector(),
        coloring_algorithm=GreedyColoringAlgorithm()
    )
    ]</code></pre><pre><code class="nohighlight hljs">6-element Vector{ADTypes.AbstractADType}:
 ADTypes.AutoEnzyme(mode=EnzymeCore.ReverseMode{false, false, EnzymeCore.FF
IABI, false, false}())
 ADTypes.AutoEnzyme(mode=EnzymeCore.ForwardMode{false, EnzymeCore.FFIABI, f
alse, false}())
 ADTypes.AutoMooncake{Nothing}(nothing)
 ADTypes.AutoForwardDiff()
 ADTypes.AutoSparse(dense_ad=ADTypes.AutoForwardDiff(), sparsity_detector=S
parseConnectivityTracer.TracerSparsityDetector(), coloring_algorithm=Sparse
MatrixColorings.GreedyColoringAlgorithm{:direct, SparseMatrixColorings.Natu
ralOrder}(SparseMatrixColorings.NaturalOrder()))
 ADTypes.AutoSparse(dense_ad=ADTypes.AutoEnzyme(mode=EnzymeCore.ForwardMode
{false, EnzymeCore.FFIABI, false, false}()), sparsity_detector=SparseConnec
tivityTracer.TracerSparsityDetector(), coloring_algorithm=SparseMatrixColor
ings.GreedyColoringAlgorithm{:direct, SparseMatrixColorings.NaturalOrder}(S
parseMatrixColorings.NaturalOrder()))</code></pre><h2 id="Diffusion-operator-simple-loop"><a class="docs-heading-anchor" href="#Diffusion-operator-simple-loop">Diffusion operator simple loop</a><a id="Diffusion-operator-simple-loop-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-operator-simple-loop" title="Permalink"></a></h2><pre><code class="language-julia hljs">uin() = 0.0
uout() = 0.0
function Diffusion(u)
    du = zero(u)
    for i in eachindex(du,u)
        if i == 1
            ug = uin()
            ud = u[i+1]
        elseif i == length(u)
            ug = u[i-1]
            ud = uout()
        else
            ug = u[i-1]
            ud = u[i+1] 
        end
        du[i] = ug + ud -2*u[i]
    end
    return du
end;</code></pre><h2 id="Manual-jacobian"><a class="docs-heading-anchor" href="#Manual-jacobian">Manual jacobian</a><a id="Manual-jacobian-1"></a><a class="docs-heading-anchor-permalink" href="#Manual-jacobian" title="Permalink"></a></h2><pre><code class="language-julia hljs">function DDiffusion(u)
    A = diagm(
        -1 =&gt; ones(length(u)-1),
        0=&gt;-2 .*ones(length(u)),
        1 =&gt; ones(length(u)-1))
    return A
end;</code></pre><h2 id="Define-Scenarios"><a class="docs-heading-anchor" href="#Define-Scenarios">Define Scenarios</a><a id="Define-Scenarios-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Scenarios" title="Permalink"></a></h2><pre><code class="language-julia hljs">u = rand(1000)
scenarios = [ Scenario{:jacobian,:out}(Diffusion,u,res1=DDiffusion(u))];</code></pre><h2 id="Run-Benchmarks"><a class="docs-heading-anchor" href="#Run-Benchmarks">Run Benchmarks</a><a id="Run-Benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Run-Benchmarks" title="Permalink"></a></h2><pre><code class="language-julia hljs">df = benchmark_differentiation(bcks, scenarios)
table = PrettyTables.pretty_table(
    String,
    df;
    backend=Val(:markdown),
    header=names(df),
    formatters=PrettyTables.ft_printf(&quot;%.1e&quot;),
)

Markdown.parse(table)</code></pre><pre><code class="nohighlight hljs">Test Summary:                                                              
                                                                           
                                                                           
                                                                           
                                       | Pass  Total     Time
Testing benchmarks                                                         
                                                                           
                                                                           
                                                                           
                                       |   12     12  1m32.1s
  ADTypes.AutoEnzyme(mode=EnzymeCore.ReverseMode{false, false, EnzymeCore.F
FIABI, false, false}())                                                    
                                                                           
                                                                           
                                       |    2      2    23.9s
  ADTypes.AutoEnzyme(mode=EnzymeCore.ForwardMode{false, EnzymeCore.FFIABI, 
false, false}())                                                           
                                                                           
                                                                           
                                       |    2      2    22.6s
  ADTypes.AutoMooncake{Nothing}(nothing)                                   
                                                                           
                                                                           
                                                                           
                                       |    2      2    34.0s
  ADTypes.AutoForwardDiff()                                                
                                                                           
                                                                           
                                                                           
                                       |    2      2     4.1s
  ADTypes.AutoSparse(dense_ad=ADTypes.AutoForwardDiff(), sparsity_detector=
SparseConnectivityTracer.TracerSparsityDetector(), coloring_algorithm=Spars
eMatrixColorings.GreedyColoringAlgorithm{:direct, SparseMatrixColorings.Nat
uralOrder}(SparseMatrixColorings.NaturalOrder()))                          
                                       |    2      2     4.1s
  ADTypes.AutoSparse(dense_ad=ADTypes.AutoEnzyme(mode=EnzymeCore.ForwardMod
e{false, EnzymeCore.FFIABI, false, false}()), sparsity_detector=SparseConne
ctivityTracer.TracerSparsityDetector(), coloring_algorithm=SparseMatrixColo
rings.GreedyColoringAlgorithm{:direct, SparseMatrixColorings.NaturalOrder}(
SparseMatrixColorings.NaturalOrder())) |    2      2     3.2s</code></pre><table><tr><th style="text-align: right"><strong>backend</strong></th><th style="text-align: right"><strong>scenario</strong></th><th style="text-align: right"><strong>operator</strong></th><th style="text-align: right"><strong>prepared</strong></th><th style="text-align: right"><strong>calls</strong></th><th style="text-align: right"><strong>samples</strong></th><th style="text-align: right"><strong>evals</strong></th><th style="text-align: right"><strong>time</strong></th><th style="text-align: right"><strong>allocs</strong></th><th style="text-align: right"><strong>bytes</strong></th><th style="text-align: right"><strong>gc_fraction</strong></th><th style="text-align: right"><strong>compile_fraction</strong></th></tr><tr><td style="text-align: right">AutoEnzyme(mode=ReverseMode{false, false, FFIABI, false, false}())</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.4e+01</td><td style="text-align: right">1.8e+01</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">4.5e-02</td><td style="text-align: right">2.3e+03</td><td style="text-align: right">2.8e+08</td><td style="text-align: right">4.7e-02</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoEnzyme(mode=ReverseMode{false, false, FFIABI, false, false}())</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.3e+01</td><td style="text-align: right">1.9e+01</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">4.4e-02</td><td style="text-align: right">2.3e+03</td><td style="text-align: right">2.8e+08</td><td style="text-align: right">4.7e-02</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoEnzyme(mode=ForwardMode{false, FFIABI, false, false}())</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.3e+01</td><td style="text-align: right">1.3e+02</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.8e-03</td><td style="text-align: right">3.2e+03</td><td style="text-align: right">1.8e+07</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoEnzyme(mode=ForwardMode{false, FFIABI, false, false}())</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.3e+01</td><td style="text-align: right">1.3e+02</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.2e-03</td><td style="text-align: right">3.2e+03</td><td style="text-align: right">1.8e+07</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoMooncake{Nothing}(nothing)</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">2.0e+00</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.0e-01</td><td style="text-align: right">1.0e+04</td><td style="text-align: right">4.0e+09</td><td style="text-align: right">5.7e-02</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoMooncake{Nothing}(nothing)</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">2.0e+00</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">6.1e-01</td><td style="text-align: right">1.0e+04</td><td style="text-align: right">4.0e+09</td><td style="text-align: right">6.0e-02</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoForwardDiff()</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">8.5e+01</td><td style="text-align: right">2.3e+02</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">3.7e-03</td><td style="text-align: right">1.7e+02</td><td style="text-align: right">1.7e+07</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoForwardDiff()</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">8.4e+01</td><td style="text-align: right">2.4e+02</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">3.7e-03</td><td style="text-align: right">1.7e+02</td><td style="text-align: right">1.7e+07</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoSparse(dense<em>ad=AutoForwardDiff(), sparsity</em>detector=TracerSparsityDetector(), coloring_algorithm=GreedyColoringAlgorithm{:direct, NaturalOrder}(NaturalOrder()))</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">2.0e+00</td><td style="text-align: right">4.1e+04</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.4e-05</td><td style="text-align: right">8.0e+00</td><td style="text-align: right">9.6e+04</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoSparse(dense<em>ad=AutoForwardDiff(), sparsity</em>detector=TracerSparsityDetector(), coloring_algorithm=GreedyColoringAlgorithm{:direct, NaturalOrder}(NaturalOrder()))</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">4.8e+04</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.2e-05</td><td style="text-align: right">7.0e+00</td><td style="text-align: right">8.8e+04</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoSparse(dense<em>ad=AutoEnzyme(mode=ForwardMode{false, FFIABI, false, false}()), sparsity</em>detector=TracerSparsityDetector(), coloring_algorithm=GreedyColoringAlgorithm{:direct, NaturalOrder}(NaturalOrder()))</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">value<em>and</em>jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">2.0e+00</td><td style="text-align: right">4.8e+04</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.3e-05</td><td style="text-align: right">1.0e+01</td><td style="text-align: right">9.7e+04</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr><tr><td style="text-align: right">AutoSparse(dense<em>ad=AutoEnzyme(mode=ForwardMode{false, FFIABI, false, false}()), sparsity</em>detector=TracerSparsityDetector(), coloring_algorithm=GreedyColoringAlgorithm{:direct, NaturalOrder}(NaturalOrder()))</td><td style="text-align: right">Scenario{:jacobian,:out} Diffusion : Vector{Float64} -&gt; Vector{Float64}</td><td style="text-align: right">jacobian</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">5.4e+04</td><td style="text-align: right">1.0e+00</td><td style="text-align: right">1.3e-05</td><td style="text-align: right">9.0e+00</td><td style="text-align: right">8.9e+04</td><td style="text-align: right">0.0e+00</td><td style="text-align: right">0.0e+00</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../BrusselatorSparseAD/">« Brusselator sparse AD benchmarks</a><a class="docs-footer-nextpage" href="../../NonStiffODE/EnrightPryce_wpd/">Enright-Pryce Work-Precision Diagrams »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 24 October 2025 17:34">Friday 24 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
