<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tensor Product Function · The SciML Benchmarks</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://benchmarks.sciml.ai/stable/Surrogates/tensor_product/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="The SciML Benchmarks logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">The SciML Benchmarks</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLBenchmarks.jl: Benchmarks for Scientific Machine Learning (SciML) and Equation Solvers</a></li><li><span class="tocitem">Multi-Language Wrapper Benchmarks</span><ul><li><a class="tocitem" href="../../MultiLanguage/ode_wrapper_packages/">ODE Solver Multi-Language Wrapper Package Work-Precision Benchmarks (MATLAB, SciPy, Julia, deSolve (R))</a></li><li><a class="tocitem" href="../../MultiLanguage/special_benchmarks/">Special Multi-Language Differential Equation Solver Comparison Benchmarks</a></li></ul></li><li><span class="tocitem">Linear Solvers</span><ul><li><a class="tocitem" href="../../LinearSolve/LUFactorization/">LU Factorization Benchmarks</a></li><li><a class="tocitem" href="../../LinearSolve/SparsePDE/">Finite Difference Sparse PDE Jacobian Factorization Benchmarks</a></li></ul></li><li><span class="tocitem">Interval Rootfinding</span><ul><li><a class="tocitem" href="../../IntervalNonlinearProblem/simpleintervalrootfind/">Simple Interval Rootfinding (NonlinearSolve.jl vs Roots.jl vs MATLAB)</a></li></ul></li><li><span class="tocitem">Nonlinear Solvers</span><ul><li><a class="tocitem" href="../../NonlinearProblem/nonlinear_battery_problem/">Battery Problem</a></li><li><a class="tocitem" href="../../NonlinearProblem/nonlinear_solver_23_tests/">Nonlinear Solver 23 Test Problems</a></li><li><a class="tocitem" href="../../NonlinearProblem/quadratic_nonlinear/">Quadratic Nonlinear Rootfinding Benchmark</a></li></ul></li><li><span class="tocitem">Non-Stiff Ordinary Differential Equations (ODEs)</span><ul><li><a class="tocitem" href="../../NonStiffODE/FitzhughNagumo_wpd/">Fitzhugh-Nagumo Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/LotkaVolterra_wpd/">Lotka-Volterra Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/Pleiades_wpd/">Pleiades Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/RigidBody_wpd/">Rigid Body Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/ThreeBody_wpd/">Three Body Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffODE/linear_wpd/">100 Independent Linear Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Ordinary Differential Equations (ODEs)</span><ul><li><a class="tocitem" href="../../StiffODE/Bruss/">Brusselator Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Hires/">HIRES Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Orego/">OREGO Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/Pollution/">POLLU Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/ROBER/">ROBER Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../StiffODE/VanDerPol/">VanDerPol Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Biological Differential Equations</span><ul><li><a class="tocitem" href="../../Bio/BCR/">BCR Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/Bidkhori2012/">Bidkhori2012 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/egfr_net/">Egfr_net Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/fceri_gamma2/">Fceri_gamma2 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/multisite2/">Multisite2 Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../Bio/multistate/">Multistate Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Differential-Algebraic Equations (DAEs)</span><ul><li><a class="tocitem" href="../../DAE/ChemicalAkzoNobel/">Chemical Akzo Nobel Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/OregoDAE/">OREGO Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../DAE/ROBERDAE/">ROBER Differential-Algebraic Equation (DAE) Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Boundary Value Problems (BVPs)</span><ul><li><a class="tocitem" href="../../NonStiffBVP/linear_wpd/">Linear BVP Benchmarks</a></li><li><a class="tocitem" href="../../NonStiffBVP/orbital/">Orbital Dynamics BVP Benchmark</a></li></ul></li><li><span class="tocitem">Simple Handwritten Partial Differential Equations (PDEs) as ODEs</span><ul><li><a class="tocitem" href="../../SimpleHandwrittenPDE/allen_cahn_fdm_wpd/">Allen_Cahn FDM Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/allen_cahn_spectral_wpd/">Allen-Cahn Pseudospectral Methods Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/burgers_fdm_wpd/">Burgers FDM Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/burgers_spectral_wpd/">Burgers Pseudospectral Methods Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/kdv_fdm_wpd/">KdV FDM Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/kdv_spectral_wpd/">KdV Pseudospectral Methods Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/ks_fdm_wpd/">KS FDM Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../SimpleHandwrittenPDE/ks_spectral_wpd/">KS Pseudospectral Methods Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Complicated Partial Differential Equations (PDEs)</span><ul><li><a class="tocitem" href="../../ComplicatedPDE/Filament/">Filament Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../ComplicatedPDE/SpringBlockNonLinearResistance/">Spring-Block PDE Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Dynamical ODEs (Hamiltonian and Second Order)</span><ul><li><a class="tocitem" href="../../DynamicalODE/Henon-Heiles_energy_conservation_benchmark/">Hénon-Heiles Energy Conservation</a></li><li><a class="tocitem" href="../../DynamicalODE/Quadrupole_boson_Hamiltonian_energy_conservation_benchmark/">Quadruple Boson Energy Conservation</a></li><li><a class="tocitem" href="../../DynamicalODE/single_pendulums/">Single Pedulum Comparison</a></li></ul></li><li><span class="tocitem">N-Body Problem Benchmarks</span><ul><li><a class="tocitem" href="../../NBodySimulator/acceleration_functions/">Acceleration function benchmarks</a></li><li><a class="tocitem" href="../../NBodySimulator/liquid_argon/">Liquid argon benchmarks</a></li></ul></li><li><span class="tocitem">Non-Stiff Stochastic Differential Equations (SDEs)</span><ul><li><a class="tocitem" href="../../NonStiffSDE/BasicSDEWeakWorkPrecision/">SDE Basic Weak Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffSDE/BasicSDEWorkPrecision/">SDE Basic Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Stochastic Differential Equations (SDEs)</span><ul><li><a class="tocitem" href="../../StiffSDE/Oval2LongRun/">Oval2 Long Run</a></li><li><a class="tocitem" href="../../StiffSDE/Oval2LongTimes/">Oval2 Long Times</a></li><li><a class="tocitem" href="../../StiffSDE/Oval2Timings/">Oval2 Timings</a></li><li><a class="tocitem" href="../../StiffSDE/QuadraticStiffness/">Quadratic Stiffness Benchmarks</a></li><li><a class="tocitem" href="../../StiffSDE/StochasticHeat/">Stochastic Heat Equation Benchmarks</a></li></ul></li><li><span class="tocitem">Non-Stiff Delay Differential Equations (DDEs)</span><ul><li><a class="tocitem" href="../../NonStiffDDE/Mackey_Glass_wpd/">Mackey and Glass Work-Precision Diagrams</a></li><li><a class="tocitem" href="../../NonStiffDDE/Wheldon_Kirk_Finlay_wpd/">Wheldon, Kirk, and Finlay Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Stiff Delay Differential equations (DDEs)</span><ul><li><a class="tocitem" href="../../StiffDDE/QuorumSensing/">Quorum Sensing Work-Precision Diagrams</a></li></ul></li><li><span class="tocitem">Jump Process Equations (Gillespie Benchmarks)</span><ul><li><a class="tocitem" href="../../Jumps/Diffusion_CTRW/">Diffusion Model</a></li><li><a class="tocitem" href="../../Jumps/Mendes_multistate_example/">Mendes Multistate Model</a></li><li><a class="tocitem" href="../../Jumps/MultivariateHawkes/">Multivariate Hawkes Model</a></li><li><a class="tocitem" href="../../Jumps/NegFeedback_GeneExpr/">Negative Feedback Gene Expression Model</a></li><li><a class="tocitem" href="../../Jumps/NegFeedback_GeneExpr_Marchetti/">Negative Feedback Marchetti Model</a></li><li><a class="tocitem" href="../../Jumps/Spatial_Signaling_Sanft/">Spatial Signaling Model from Sanft and Othmer (2015)</a></li></ul></li><li><span class="tocitem">Hybrid (Time-Dependent) Jump Processes</span><ul><li><a class="tocitem" href="../../HybridJumps/Synapse/">Synapse model</a></li></ul></li><li><span class="tocitem">Nonlinear Optimization Solver Benchmarks</span><ul><li><a class="tocitem" href="../../Optimizaton/2drosenbrock/">2-Dimensional Rosenbrock Function Nonlinear Optimization Benchmark</a></li></ul></li><li><span class="tocitem">Optimization Framework Benchmarks</span><ul><li><a class="tocitem" href="../../OptimizationFrameworks/clnlbeam/">CLNLBEAM Nonlinear Optimization Benchmark</a></li><li><a class="tocitem" href="../../OptimizationFrameworks/optimal_powerflow/">Optimal Powerflow Nonlinear Optimization Benchmark</a></li></ul></li><li><span class="tocitem">Parameter Estimation and Inverse Problem Benchmarks</span><ul><li><a class="tocitem" href="../../ParameterEstimation/FitzHughNagumoParameterEstimation/">FitzHugh-Nagumo Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../ParameterEstimation/LorenzParameterEstimation/">Lorenz Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../ParameterEstimation/LotkaVolterraParameterEstimation/">Lotka-Volterra Parameter Estimation Benchmarks</a></li></ul></li><li><span class="tocitem">Bayesian Inference and Probabilistic Inverse Problem Benchmarks</span><ul><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesFitzHughNagumo/">Fitzhugh-Nagumo Bayesian Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesLorenz/">Lorenz Bayesian Parameter Estimation Benchmarks</a></li><li><a class="tocitem" href="../../BayesianInference/DiffEqBayesLotkaVolterra/">Lotka-Volterra Bayesian Parameter Estimation Benchmarks</a></li></ul></li><li><span class="tocitem">MethodOfLines.jl Partial Differential Equation (PDE) Formulations</span><ul><li><a class="tocitem" href="../../MethodOfLinesPDE/MOL_fdm/">Burgers FDM Work-Precision Diagrams with Various MethodOfLines Methods</a></li></ul></li><li><span class="tocitem">Physics-Informed Neural Network (Neural Network PDE Solver) Cost Function Benchmarks</span><ul><li><a class="tocitem" href="../../PINNErrorsVsTime/allen_cahn_et/">Allen-Cahn PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/diffusion_et/">Diffusion PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/hamilton_jacobi_et/">Hamilton-Jacobi PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/level_set_et/">Level Set PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li><li><a class="tocitem" href="../../PINNErrorsVsTime/nernst_planck_et/">Nernst-Planck PDE Physics-Informed Neural Network (PINN) Loss Function Error vs Time Benchmarks</a></li></ul></li><li><span class="tocitem">Physics-Informed Neural Network (Neural Network PDE Solver) Optimizer Benchmarks</span><ul><li><a class="tocitem" href="../../PINNOptimizers/1d_diffusion/">Diffusion Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/1d_poisson_nernst_planck/">Nernst-Planck Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/allen_cahn/">Allen-Cahn Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/burgers_equation/">Berger&#39;s Equation Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/hamilton_jacobi/">Hamilton-Jacobi PDE Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li><li><a class="tocitem" href="../../PINNOptimizers/poisson/">Poisson PDE Physics-Informed Neural Network (PINN) Optimizer Benchmarks</a></li></ul></li><li><span class="tocitem">SDE Adaptivity Benchmarks</span><ul><li><a class="tocitem" href="../../AdaptiveSDE/AdaptiveEfficiencyTests/">Adaptive Efficiency Tests</a></li><li><a class="tocitem" href="../../AdaptiveSDE/qmaxDetermination/">qmax Determination</a></li></ul></li><li><span class="tocitem">Surrogate Benchmarks</span><ul><li class="is-active"><a class="tocitem" href>Tensor Product Function</a><ul class="internal"><li><a class="tocitem" href="#Package-Imports"><span>Package Imports</span></a></li><li><a class="tocitem" href="#Define-the-function"><span>Define the function</span></a></li><li><a class="tocitem" href="#Define-parameters-for-training-and-test-data"><span>Define parameters for training and test data</span></a></li><li><a class="tocitem" href="#Sample-training-and-test-data-points"><span>Sample training and test data points</span></a></li><li><a class="tocitem" href="#Plot-training-and-test-points"><span>Plot training and test points</span></a></li><li><a class="tocitem" href="#Fit-surrogate-models"><span>Fit surrogate models</span></a></li><li><a class="tocitem" href="#Predictions-on-training-and-test-data"><span>Predictions on training and test data</span></a></li><li><a class="tocitem" href="#Define-the-MSE-function"><span>Define the MSE function</span></a></li><li><a class="tocitem" href="#Calculate-MSE-for-the-models"><span>Calculate MSE for the models</span></a></li><li><a class="tocitem" href="#Compare-MSE"><span>Compare MSE</span></a></li><li><a class="tocitem" href="#Plot-predictions"><span>Plot predictions</span></a></li><li><a class="tocitem" href="#Time-evaluation"><span>Time evaluation</span></a></li><li><a class="tocitem" href="#Compare-time-performance"><span>Compare time performance</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Surrogate Benchmarks</a></li><li class="is-active"><a href>Tensor Product Function</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tensor Product Function</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLBenchmarksOutput/blob/main/docs/src/Surrogates/tensor_product.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tensor-Product-Function"><a class="docs-heading-anchor" href="#Tensor-Product-Function">Tensor Product Function</a><a id="Tensor-Product-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-Product-Function" title="Permalink"></a></h1><p>The tensor product function is defined as:</p><p><span>$f(x) =  \prod_{i=1}^{d} \cos(a\pi x_i)$</span></p><p>where:</p><ul><li>(d): Represents the dimensionality of the input vector (x).</li><li>(x_i): Represents the (i)-th component of the input vector.</li><li>(a): A constant parameter.</li></ul><h2 id="Package-Imports"><a class="docs-heading-anchor" href="#Package-Imports">Package Imports</a><a id="Package-Imports-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Imports" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Surrogates
using SurrogatesRandomForest
using Plots
using Statistics
using PrettyTables
using BenchmarkTools</code></pre><h2 id="Define-the-function"><a class="docs-heading-anchor" href="#Define-the-function">Define the function</a><a id="Define-the-function-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-function" title="Permalink"></a></h2><pre><code class="language-julia hljs">function tensor_product_function(x)
    a = 0.5
    return prod(cos.(a * π * x))
end</code></pre><pre><code class="nohighlight hljs">tensor_product_function (generic function with 1 method)</code></pre><h2 id="Define-parameters-for-training-and-test-data"><a class="docs-heading-anchor" href="#Define-parameters-for-training-and-test-data">Define parameters for training and test data</a><a id="Define-parameters-for-training-and-test-data-1"></a><a class="docs-heading-anchor-permalink" href="#Define-parameters-for-training-and-test-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">lb = -5.0 # Lower bound of sampling range
ub = 5.0  # Upper bound of sampling range
n_train = 100 # Number of training points
n_test = 150 # Number of testing points</code></pre><pre><code class="nohighlight hljs">150</code></pre><h2 id="Sample-training-and-test-data-points"><a class="docs-heading-anchor" href="#Sample-training-and-test-data-points">Sample training and test data points</a><a id="Sample-training-and-test-data-points-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-training-and-test-data-points" title="Permalink"></a></h2><pre><code class="language-julia hljs">x_train = sample(n_train, lb, ub, SobolSample())  # Sample training data points
y_train = tensor_product_function.(x_train)  # Calculate corresponding function values
x_test = sample(n_test, lb, ub, RandomSample())  # Sample larger test data set
y_test = tensor_product_function.(x_test)  # Calculate corresponding true function values</code></pre><pre><code class="nohighlight hljs">150-element Vector{Float64}:
  0.8305752462969131
 -0.033544437159193675
 -0.6619128779610377
  0.5596264328875811
  0.6574597251939587
 -0.399771720540044
  0.9912259665189641
  0.21190087950039685
  0.7587325185446382
 -0.7587946039832388
  ⋮
 -0.754167185436482
 -0.8664366348825658
  0.045572772931094095
  0.9608814440746848
 -0.5818384926539936
 -0.9672703385192788
 -0.4843577936189141
  0.8878177091150425
 -0.889416515883492</code></pre><h2 id="Plot-training-and-test-points"><a class="docs-heading-anchor" href="#Plot-training-and-test-points">Plot training and test points</a><a id="Plot-training-and-test-points-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-training-and-test-points" title="Permalink"></a></h2><pre><code class="language-julia hljs">scatter(x_train, y_train, label=&quot;Training Points&quot;, xlabel=&quot;X-axis&quot;, ylabel=&quot;Y-axis&quot;, legend=:topright)
scatter!(x_test, y_test, label=&quot;Testing Points&quot;)</code></pre><p><img src="../figures/tensor_product_5_1.png" alt/></p><h2 id="Fit-surrogate-models"><a class="docs-heading-anchor" href="#Fit-surrogate-models">Fit surrogate models</a><a id="Fit-surrogate-models-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-surrogate-models" title="Permalink"></a></h2><pre><code class="language-julia hljs">randomforest_surrogate = RandomForestSurrogate(x_train, y_train, lb, ub, num_round = 10)
radial_surrogate = RadialBasis(x_train, y_train, lb, ub)
kriging_surrogate = Kriging(x_train, y_train, lb, ub)
loba_surrogate = LobachevskySurrogate(x_train, y_train, lb, ub, alpha = 2.0, n = 6)</code></pre><pre><code class="nohighlight hljs">(::Surrogates.LobachevskySurrogate{Vector{Float64}, Vector{Float64}, Float6
4, Int64, Float64, Float64, Vector{Float64}, Bool}) (generic function with 
2 methods)</code></pre><h2 id="Predictions-on-training-and-test-data"><a class="docs-heading-anchor" href="#Predictions-on-training-and-test-data">Predictions on training and test data</a><a id="Predictions-on-training-and-test-data-1"></a><a class="docs-heading-anchor-permalink" href="#Predictions-on-training-and-test-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">## Training data
random_forest_train_pred = randomforest_surrogate.(x_train)
radial_train_pred = radial_surrogate.(x_train)
kriging_train_pred = kriging_surrogate.(x_train)
loba_train_pred = loba_surrogate.(x_train)

## Test data
random_forest_test_pred = randomforest_surrogate.(x_test)
radial_test_pred = radial_surrogate.(x_test)
kriging_test_pred = kriging_surrogate.(x_test)
loba_test_pred = loba_surrogate.(x_test)</code></pre><pre><code class="nohighlight hljs">150-element Vector{Float64}:
  0.8305833038315116
 -0.03354607927309772
 -0.6619015721397044
  0.559602172018074
  0.6574632429483609
 -0.3997761523856962
  0.9912460769957562
  0.21193377422749737
  0.7587327137353479
 -0.7587834325444476
  ⋮
 -0.7541566404378912
 -0.8664191088053832
  0.046810492201239576
  0.9608823131447458
 -0.5818435032691411
 -0.9672344657432858
 -0.48438867719886664
  0.8878349713116643
 -0.8894030638020265</code></pre><h2 id="Define-the-MSE-function"><a class="docs-heading-anchor" href="#Define-the-MSE-function">Define the MSE function</a><a id="Define-the-MSE-function-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-MSE-function" title="Permalink"></a></h2><pre><code class="language-julia hljs">function calculate_mse(predictions, true_values)
    return mean((predictions .- true_values).^2)  # Calculate mean of squared errors
end</code></pre><pre><code class="nohighlight hljs">calculate_mse (generic function with 1 method)</code></pre><h2 id="Calculate-MSE-for-the-models"><a class="docs-heading-anchor" href="#Calculate-MSE-for-the-models">Calculate MSE for the models</a><a id="Calculate-MSE-for-the-models-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-MSE-for-the-models" title="Permalink"></a></h2><pre><code class="language-julia hljs">## Training MSE
mse_rf_train = calculate_mse(random_forest_train_pred, y_train)
mse_radial_train = calculate_mse(radial_train_pred, y_train)
mse_krig_train = calculate_mse(kriging_train_pred, y_train)
mse_loba_train = calculate_mse(loba_train_pred, y_train)

## Test MSE
mse_rf_test = calculate_mse(random_forest_test_pred, y_test)
mse_radial_test = calculate_mse(radial_test_pred, y_test)
mse_krig_test = calculate_mse(kriging_test_pred, y_test)
mse_loba_test = calculate_mse(loba_test_pred, y_test)</code></pre><pre><code class="nohighlight hljs">1.7795633469563856e-8</code></pre><h2 id="Compare-MSE"><a class="docs-heading-anchor" href="#Compare-MSE">Compare MSE</a><a id="Compare-MSE-1"></a><a class="docs-heading-anchor-permalink" href="#Compare-MSE" title="Permalink"></a></h2><pre><code class="language-julia hljs">models = [&quot;Random Forest&quot;, &quot;Radial Basis&quot;, &quot;Kriging&quot;, &quot;Lobachevsky&quot;]
train_mses = [mse_rf_train, mse_radial_train, mse_krig_train, mse_loba_train]
test_mses = [mse_rf_test, mse_radial_test, mse_krig_test, mse_loba_test]
mses = sort(collect(zip(test_mses, train_mses, models)))
pretty_table(hcat(getindex.(mses, 3), getindex.(mses, 2), getindex.(mses, 1)), header=[&quot;Model&quot;, &quot;Training MSE&quot;, &quot;Test MSE&quot;])</code></pre><pre><code class="nohighlight hljs">┌───────────────┬──────────────┬─────────────┐
│         Model │ Training MSE │    Test MSE │
├───────────────┼──────────────┼─────────────┤
│   Lobachevsky │   3.7375e-19 │  1.77956e-8 │
│       Kriging │   1.16824e-5 │  1.38763e-5 │
│  Radial Basis │  1.74579e-30 │ 0.000115666 │
│ Random Forest │   0.00176894 │  0.00834948 │
└───────────────┴──────────────┴─────────────┘</code></pre><h2 id="Plot-predictions"><a class="docs-heading-anchor" href="#Plot-predictions">Plot predictions</a><a id="Plot-predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-predictions" title="Permalink"></a></h2><pre><code class="language-julia hljs">xs = -5:0.01:5
plot(xs, tensor_product_function.(xs), label=&quot;True function&quot;, legend=:top, color=:black)
plot!(xs, randomforest_surrogate.(xs), label=&quot;Random Forest&quot;, legend=:top, color=:green)
plot!(xs, radial_surrogate.(xs), label=&quot;Radial Basis&quot;, legend=:top, color=:red)
plot!(xs, kriging_surrogate.(xs), label=&quot;Kriging&quot;, legend=:top, color=:blue)
plot!(xs, loba_surrogate.(xs), label=&quot;Lobachevsky&quot;, legend=:top, color=:purple)</code></pre><p><img src="../figures/tensor_product_11_1.png" alt/></p><h2 id="Time-evaluation"><a class="docs-heading-anchor" href="#Time-evaluation">Time evaluation</a><a id="Time-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Time-evaluation" title="Permalink"></a></h2><pre><code class="language-julia hljs">time_original = @belapsed tensor_product_function.(x_test)
time_rf = @belapsed randomforest_surrogate.(x_test)
time_radial = @belapsed radial_surrogate.(x_test)
time_krig = @belapsed kriging_surrogate.(x_test)
time_loba = @belapsed loba_surrogate.(x_test)</code></pre><pre><code class="nohighlight hljs">0.001412517</code></pre><h2 id="Compare-time-performance"><a class="docs-heading-anchor" href="#Compare-time-performance">Compare time performance</a><a id="Compare-time-performance-1"></a><a class="docs-heading-anchor-permalink" href="#Compare-time-performance" title="Permalink"></a></h2><pre><code class="language-julia hljs">times = [&quot;Random Forest&quot; =&gt; time_rf, &quot;Radial Basis&quot; =&gt; time_radial, &quot;Kriging&quot; =&gt; time_krig, &quot;Lobachevsky&quot; =&gt; time_loba, &quot;Original Function&quot; =&gt; time_original]
sorted_times = sort(times, by=x-&gt;x[2])
pretty_table(hcat(first.(sorted_times), last.(sorted_times)), header=[&quot;Model&quot;, &quot;Time(s)&quot;])</code></pre><pre><code class="nohighlight hljs">┌───────────────────┬─────────────┐
│             Model │     Time(s) │
├───────────────────┼─────────────┤
│ Original Function │     1.49e-6 │
│           Kriging │ 0.000338547 │
│       Lobachevsky │  0.00141252 │
│      Radial Basis │  0.00188718 │
│     Random Forest │  0.00406976 │
└───────────────────┴─────────────┘</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../AdaptiveSDE/qmaxDetermination/">« qmax Determination</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 2 February 2024 12:39">Friday 2 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
